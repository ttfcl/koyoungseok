<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>koyoungseok ì£¼ì‹ì»¨íŠ¸ë¡¤ëŸ¬</title>

    <!-- âœ… Firebase SDK CDN ì¶”ê°€ -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <!-- âœ… ìŠ¤íƒ€ì¼ ì¶”ê°€ -->
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f4f4f9;
            text-align: center;
            padding: 20px;
        }
        h1 {
            color: #333;
        }
        .container {
            max-width: 400px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
        }
        .data-container, .form-container, .guide {
            background: #fff;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.1);
            text-align: left;
        }
        .data-container p, .guide p {
            margin: 5px 0;
            font-size: 14px;
        }
        .data-container span {
            font-weight: bold;
            color: #007bff;
        }
        label {
            font-size: 14px;
            display: block;
            margin-top: 10px;
            text-align: left;
        }
        select, input {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        button {
            width: 100%;
            background: #007bff;
            color: white;
            border: none;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }
        button:hover {
            background: #0056b3;
        }
        .guide {
            font-size: 12px;
            background: #eef5ff;
            border-left: 5px solid #007bff;
            padding: 10px;
            text-align: left;
        }
        .guide strong {
            color: #0056b3;
        }
    </style>
</head>
<body>
    <h1>koyoungseok ì£¼ì‹ì»¨íŠ¸ë¡¤ëŸ¬</h1>
    <div class="container">

        <!-- ğŸ”¹ Firestore ë°ì´í„° í‘œì‹œ (ì½ê¸° ì „ìš©) -->
        <div class="data-container">
            <h3>ğŸ“Š í˜„ì¬ ì„¤ì •</h3>
            <p>ì‘ë™ìƒíƒœ: <span id="current-handler">-</span></p>
            <p>ìµì ˆë¥ : <span id="current-pp">-</span>%</p>
            <p>ì†ì ˆë¥ : <span id="current-mp">-</span>%</p>
            <p>ì¢…ëª©ë‹¹ ë§¤ìˆ˜ê¸ˆì•¡: <span id="current-money">-</span>ì›</p>
        </div>

        <!-- ğŸ”¹ ìƒˆë¡œìš´ ê°’ ì…ë ¥ -->
        <div class="form-container">
            <h3>âš™ ë³€ê²½ ì„¤ì •</h3>
            <label>ë³€ê²½í•  ì‘ë™ìƒíƒœ:</label>
            <select id="handler">
                <option value="true">true</option>
                <option value="false">false</option>
            </select>

            <label>ë³€ê²½í•  ìµì ˆë¥ :</label>
            <select id="pp"></select>

            <label>ë³€ê²½í•  ì†ì ˆë¥ :</label>
            <select id="mp"></select>

            <label>ë³€ê²½í•  ì¢…ëª©ë‹¹ ë§¤ìˆ˜ê¸ˆì•¡(ì›):</label>
            <input type="number" id="money" value="0">

            <button onclick="updateData()">ìˆ˜ì •í•˜ê¸°</button>
        </div>

        <!-- ğŸ”¹ ì„¤ëª…ì„œ -->
        <div class="guide">
            <h3>ğŸ“Œ ì„¤ëª…ì„œ</h3>
            <p>1ï¸âƒ£ í•œë²ˆ ìˆ˜ì •í•˜ë©´ <strong>30ë¶„ í›„</strong> ë‹¤ì‹œ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
            <p>2ï¸âƒ£ ëª¨ë“  ë³€ê²½ ì‚¬í•­ì€ <strong>ë‹¤ìŒ ì£¼ì‹ ì˜ì—…ì¼ë¶€í„°</strong> ì ìš©ë©ë‹ˆë‹¤.</p>
            <p>3ï¸âƒ£ ì‘ë™ìƒíƒœê°€ <strong>false</strong>ì´ë©´ ì‘ë™í•˜ì§€ ì•Šìœ¼ë©°, <strong>true</strong>ì´ë©´ ì‘ë™í•©ë‹ˆë‹¤.<br>
            &nbsp;&nbsp;&nbsp;ë‹¨, ì£¼ì‹íœ´ì¥ì¼ì—ëŠ” ì‘ë™í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
            <p>4ï¸âƒ£ ë§¤ìˆ˜ê¸ˆì•¡ ë‹¨ìœ„ëŠ” 1ì› ë‹¨ìœ„ì…ë‹ˆë‹¤.<br>
            &nbsp;&nbsp;&nbsp;ì˜ˆ: <strong>20000 ì…ë ¥ â†’ 1900ì›ì§œë¦¬ ì£¼ì‹ 10ì£¼ ë§¤ìˆ˜</strong></p>
            <p>5ï¸âƒ£ ìµœëŒ€ ë§¤ìˆ˜ ì¢…ëª©ìˆ˜ëŠ” <strong>8ê°œ</strong>ì´ë¯€ë¡œ ì´ ìë³¸ê³¼ ì¢…ëª© ìˆ˜ë¥¼ ê³ ë ¤í•˜ì„¸ìš”.</p>
        </div>

    </div>

    <script>
        // Firebase ì„¤ì •
        //
        const firebaseConfig = {
            apiKey: "AIzaSyCq0arXZO1X91wkmXfJFczNlkcoBdC2Yc4",
            authDomain: "usatelegrambotbdbc.firebaseapp.com",
            projectId: "usatelegrambotbdbc",
            storageBucket: "usatelegrambotbdbc.firebasestorage.app",
            messagingSenderId: "109045263714",
            appId: "1:109045263714:web:846d3fd0f302139dc6903b"
        };

        // Firebase ì´ˆê¸°í™”
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const USER_ID = "koyoungseok";

        function loadData() {
            const docRef = db.collection(USER_ID).doc("investment");
            docRef.get().then((doc) => {
                if (doc.exists) {
                    document.getElementById("current-handler").textContent = doc.data().handler;
                    document.getElementById("current-pp").textContent = doc.data().pp;
                    document.getElementById("current-mp").textContent = doc.data().mp;
                    document.getElementById("current-money").textContent = doc.data().money;
                } else {
                    console.log("âŒ Firestore ë¬¸ì„œê°€ ì—†ìŠµë‹ˆë‹¤!");
                }
            }).catch((error) => {
                console.error("ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ", error);
            });
        }

        // 5ï¸âƒ£ Firestore ë°ì´í„° ì—…ë°ì´íŠ¸ (30ë¶„ ì œí•œ ì ìš©)
        function updateData() {
            const lastUpdateTime = localStorage.getItem("lastUpdateTime");
            const now = new Date().getTime();
            const THIRTY_MINUTES = 30 * 60 * 1000;

            if (lastUpdateTime && now - lastUpdateTime < THIRTY_MINUTES) {
                const remainingTime = Math.ceil((THIRTY_MINUTES - (now - lastUpdateTime)) / 60000);
                alert(`âŒ 30ë¶„ ë‚´ì—ëŠ” ë‹¤ì‹œ ìˆ˜ì •í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë‚¨ì€ ì‹œê°„: ${remainingTime}ë¶„`);
                return;
            }

            const docRef = db.collection(USER_ID).doc("investment");

            const newHandler = document.getElementById("handler").value;
            const newMoney = Number(document.getElementById("money").value);
            const newPP = parseFloat(document.getElementById("pp").value);
            const newMP = parseFloat(document.getElementById("mp").value);

            docRef.update({
                handler: newHandler,
                money: newMoney,
                pp: newPP,
                mp: newMP
            }).then(() => {
                localStorage.setItem("lastUpdateTime", now);
                alert("âœ… ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤!");
                loadData();
            }).catch((error) => {
                console.error("ë°ì´í„° ì—…ë°ì´íŠ¸ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ", error);
            });
        }

        function generateOptions() {
            for (let i = 0.1; i <= 20.0; i += 0.1) {
                document.getElementById("pp").innerHTML += `<option value="${i.toFixed(1)}">${i.toFixed(1)}%</option>`;
            }
            for (let i = -0.1; i >= -10.0; i -= 0.1) {
                document.getElementById("mp").innerHTML += `<option value="${i.toFixed(1)}">${i.toFixed(1)}%</option>`;
            }
        }

        window.onload = function () {
            generateOptions();
            loadData();
        };
    </script>
</body>
</html>
